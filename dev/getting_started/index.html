<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · Experimenter.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://JamieMair.github.io/Experimenter.jl/getting_started/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Experimenter.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Opening-the-database"><span>Opening the database</span></a></li><li><a class="tocitem" href="#Defining-the-work-we-want-to-process"><span>Defining the work we want to process</span></a></li><li><a class="tocitem" href="#Creating-an-experiment"><span>Creating an experiment</span></a></li><li><a class="tocitem" href="#Examining-the-trials-of-an-experiment"><span>Examining the trials of an experiment</span></a></li><li><a class="tocitem" href="#Executing-an-experiment"><span>Executing an experiment</span></a></li><li><a class="tocitem" href="#Getting-the-results"><span>Getting the results</span></a></li><li><a class="tocitem" href="#Re-running-failed-trials"><span>Re-running failed trials</span></a></li><li><a class="tocitem" href="#Saving-part-way"><span>Saving part way</span></a></li><li><a class="tocitem" href="#What-is-an-Experiment?"><span>What is an <code>Experiment</code>?</span></a></li></ul></li><li><a class="tocitem" href="../execution/">Running your Experiments</a></li><li><a class="tocitem" href="../distributed/">Distributed Execution</a></li><li><a class="tocitem" href="../store/">Data Store</a></li><li><a class="tocitem" href="../snapshots/">Custom Snapshots</a></li><li><a class="tocitem" href="../clusters/">Cluster Support</a></li><li><a class="tocitem" href="../api/">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JamieMair/Experimenter.jl/blob/main/docs/src/getting_started.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p><code>Experimenter.jl</code> is a package that is designed to help you keep track of your experiments and their results. It is built to work with <code>Distributed.jl</code> for parallel writing of results to a SQLite database file.</p><h2 id="Opening-the-database"><a class="docs-heading-anchor" href="#Opening-the-database">Opening the database</a><a id="Opening-the-database-1"></a><a class="docs-heading-anchor-permalink" href="#Opening-the-database" title="Permalink"></a></h2><p>To get started, first import the library with:</p><pre><code class="language-julia hljs">using Experimenter</code></pre><p>After this one needs to create a database to store the results:</p><pre><code class="language-julia hljs">db = open_db(&quot;experiments.db&quot;)</code></pre><p>One can always supply a given directory for the database as well, for example:</p><pre><code class="language-julia hljs">db = open_db(&quot;experiments.db&quot;, joinpath(pwd(), &quot;results&quot;))</code></pre><p>The first call to <code>open_db</code> will check if a file already exists. If the file does not exist, <code>Experimenter.jl</code> will create the file and the schema for the database.</p><h2 id="Defining-the-work-we-want-to-process"><a class="docs-heading-anchor" href="#Defining-the-work-we-want-to-process">Defining the work we want to process</a><a id="Defining-the-work-we-want-to-process-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-work-we-want-to-process" title="Permalink"></a></h2><p>To run an experiment we need to first define a function which runs our experiment:</p><pre><code class="language-julia hljs"># in run.jl
using Random
function run_trial(config::Dict{Symbol,Any}, trial_id)
    results = Dict{Symbol, Any}()
    sigma = config[:sigma]
    N = config[:N]
    seed = config[:seed]
    rng = Random.Xoshiro(seed)
    # Perform some calculation
    results[:distance] = sum(rand(rng) * sigma for _ in 1:N)
    # Must return a Dict{Symbol, Any}, with the data we want to save
    return results
end</code></pre><h2 id="Creating-an-experiment"><a class="docs-heading-anchor" href="#Creating-an-experiment">Creating an experiment</a><a id="Creating-an-experiment-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-an-experiment" title="Permalink"></a></h2><p>Now we can define a configuration for our experiment:</p><pre><code class="language-julia hljs"># in a script
config = Dict{Symbol,Any}(
    :N =&gt; IterableVariable([10, 20]),
    :seed =&gt; IterableVariable([1234, 4321]),
    :sigma =&gt; 1.0
)</code></pre><p>This is just a dictionary, with some special wrappers <code>IterableVariable</code> for some of the config values. When we create our experiment, we pass in this configuration and the path to the file with the function to run our experiment:</p><pre><code class="language-julia hljs">experiment = Experiment(
    name=&quot;Test Experiment&quot;,
    include_file=&quot;run.jl&quot;,
    function_name=&quot;run_trial&quot;,
    configuration=deepcopy(config)
)</code></pre><h2 id="Examining-the-trials-of-an-experiment"><a class="docs-heading-anchor" href="#Examining-the-trials-of-an-experiment">Examining the trials of an experiment</a><a id="Examining-the-trials-of-an-experiment-1"></a><a class="docs-heading-anchor-permalink" href="#Examining-the-trials-of-an-experiment" title="Permalink"></a></h2><p>We can look at the set of trials this experiment will create:</p><pre><code class="language-julia hljs">for trial in experiment
    println(trial.configuration)
end
# Dict{Symbol, Any}(:N =&gt; 10, :sigma =&gt; 1.0, :seed =&gt; 1234)
# Dict{Symbol, Any}(:N =&gt; 20, :sigma =&gt; 1.0, :seed =&gt; 1234)
# Dict{Symbol, Any}(:N =&gt; 10, :sigma =&gt; 1.0, :seed =&gt; 4321)
# Dict{Symbol, Any}(:N =&gt; 20, :sigma =&gt; 1.0, :seed =&gt; 4321)</code></pre><p>or, alternatively:</p><pre><code class="language-julia hljs">trials = collect(experiment)</code></pre><p>There are multiple trials in this experiment as we used an <code>IterableVariable</code> wrapper, which says that we want to run a grid search over these specific variables.</p><h2 id="Executing-an-experiment"><a class="docs-heading-anchor" href="#Executing-an-experiment">Executing an experiment</a><a id="Executing-an-experiment-1"></a><a class="docs-heading-anchor-permalink" href="#Executing-an-experiment" title="Permalink"></a></h2><p>To execute our experiment, we use the <code>@execute</code> macro. To execute the experiment serially:</p><pre><code class="language-julia hljs">@execute experiment db SerialMode</code></pre><p>Instead of <code>SerialMode</code>, we can use <code>ThreadedMode</code> to execute via <code>Threads.@threads</code>, or use <code>DistributedMode</code> to execute via a <code>pmap</code> and run across different workers.</p><h2 id="Getting-the-results"><a class="docs-heading-anchor" href="#Getting-the-results">Getting the results</a><a id="Getting-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-the-results" title="Permalink"></a></h2><p>Once the experiments are completed, we can run:</p><pre><code class="language-julia hljs">trials = get_trials_by_name(db, &quot;Test Experiment&quot;);</code></pre><p>This will return a <code>Vector{Trial}</code>, where <code>Trial</code> has a <code>results</code> field which is the dictionary we returned from the <code>run_trial</code> function. To get the results we write:</p><pre><code class="language-julia hljs">results = [t.results for t in trials]</code></pre><h2 id="Re-running-failed-trials"><a class="docs-heading-anchor" href="#Re-running-failed-trials">Re-running failed trials</a><a id="Re-running-failed-trials-1"></a><a class="docs-heading-anchor-permalink" href="#Re-running-failed-trials" title="Permalink"></a></h2><p>If a trial did not finish, then the <code>results</code> field will be missing. Whenever we run the <code>@execute</code> macro, it will skip any trial that already has results, and only run the next trials. Therefore </p><pre><code class="language-julia hljs">@execute experiment db SerialMode</code></pre><p>will not run any more trials, as they have already been completed. However, if the execution stopped (for example killed by the SLURM scheduler due to wall time), then it will only run the trials that have not been completed.</p><h2 id="Saving-part-way"><a class="docs-heading-anchor" href="#Saving-part-way">Saving part way</a><a id="Saving-part-way-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-part-way" title="Permalink"></a></h2><p>If your trials take a long time to finish and may be cancelled during their run, you can always implement a way to save a <code>Snapshot</code>, which allows you to save data you need to restore a trial part way through running. The API for this has not yet been documented, but examples can be seen in the unit tests.</p><h2 id="What-is-an-Experiment?"><a class="docs-heading-anchor" href="#What-is-an-Experiment?">What is an <code>Experiment</code>?</a><a id="What-is-an-Experiment?-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-an-Experiment?" title="Permalink"></a></h2><p>An experiment sets up a configuration that specifies (by default) a grid search over variables. If none of the special classes such as <code>IterableVariable</code>, <code>LinearVariable</code>, <code>LogLinearVariable</code> etc are used as values in the configuration dictionary, this will specify only a single trial. However, if these special types are used, an experiment will have multiple trials, whose configurations are created via a grid search over the special <code>AbstractVariable</code>s provided, with each of these values being replaced by a single element in these iterables.</p><p>As an example the following configuration:</p><pre><code class="language-julia hljs">config = Dict{Symbol, Any}(
    :a =&gt; IterableVariable([&quot;a&quot;, &quot;b&quot;]),
    :b =&gt; LinearVariable(1, 4, 5),
    :c =&gt; &quot;constant value&quot;
)</code></pre><p>Since the first two parts are marked with a type of <code>AbstractVariable</code> (or concrete type of), these will form our grid search. The actual configurations will look like the following code:</p><pre><code class="language-julia hljs">for a in [&quot;a&quot;, &quot;b&quot;]
    for b in LinRange(1, 4, 5)
        trial_config = Dict{Symbol, Any}(
            :a =&gt; a,
            :b =&gt; b,
            :c =&gt; &quot;constant value&quot;
        )
    end
end</code></pre><p>A matched variable will not form part of the grid, but works as follows:</p><pre><code class="language-julia hljs">matched = rand(2*5)
i = 1
for a in [&quot;a&quot;, &quot;b&quot;]
    for b in LinRange(1, 4, 5)
        trial_config = Dict{Symbol, Any}(
            :a =&gt; a,
            :b =&gt; b,
            :c =&gt; &quot;constant value&quot;,
            :matched =&gt; matched[i]
        )
        i += 1
    end
end</code></pre><p>The matched variable must have as many entries as there are in the grid search.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../execution/">Running your Experiments »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 15 December 2023 15:27">Friday 15 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
